<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Analytics - POWERGRID IDP Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        powergrid: {
                            primary: "#232A7A",
                            secondary: "#DA251D", 
                            light: "#F8F9FA",
                            dark: "#495057",
                            accent: "#4A90E2"
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo and Title -->
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-600 to-green-700 rounded-lg flex items-center justify-center">
                            <i data-lucide="bar-chart-3" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-900">Team Analytics</h1>
                            <p class="text-sm text-gray-600">Performance Insights & Team Intelligence</p>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:flex items-center gap-6">
                    <a href="manager-dashboard.html" class="text-gray-600 hover:text-green-600 transition-colors">Team Overview</a>
                    <a href="manager-idp.html" class="text-gray-600 hover:text-green-600 transition-colors">IDP Management</a>
                    <a href="manager-analytics.html" class="text-green-600 font-medium border-b-2 border-green-600 pb-1">Team Analytics</a>
                    <a href="manager-development.html" class="text-gray-600 hover:text-green-600 transition-colors">Development Plans</a>
                    <div class="flex items-center gap-2">
                        <a href="manager-idp-generator.html" class="text-gray-600 hover:text-green-600 transition-colors">AI IDP Generator</a>
                        <!-- Export Controls -->
                        <select id="timeRange" onchange="updateAnalytics()" 
                                class="px-3 py-2 border border-gray-300 rounded-lg text-sm ml-4">
                            <option value="30">Last 30 Days</option>
                            <option value="90" selected>Last 90 Days</option>
                            <option value="365">Last Year</option>
                        </select>
                        <button onclick="exportTeamReport()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            <i data-lucide="download" class="w-4 h-4 inline mr-2"></i>Export
                        </button>
                    </div>
                </nav>

                <!-- User Profile Section -->
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center">
                            <span class="text-white font-bold">RK</span>
                        </div>
                        <div class="hidden md:block">
                            <div class="text-sm font-medium text-gray-900">Rajesh Kumar</div>
                            <div class="text-xs text-gray-600">Team Manager â€¢ Engineering Dept</div>
                        </div>
                    </div>
                    
                    <!-- Exit/Logout Button -->
                    <button onclick="exitApplication()" 
                            class="flex items-center justify-center w-10 h-10 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-all duration-300 shadow-md hover:shadow-lg"
                            title="Exit Application">
                        <i data-lucide="log-out" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="px-6 py-8">
        <div class="max-w-7xl mx-auto">
            <!-- Team Performance KPIs -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">92%</h3>
                            <p class="text-gray-600">Team Engagement</p>
                            <div class="flex items-center gap-1 mt-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-green-500 text-sm font-medium">+8.2%</span>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="heart" class="w-6 h-6 text-white"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">47</h3>
                            <p class="text-gray-600">Certificates Earned</p>
                            <div class="flex items-center gap-1 mt-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-green-500 text-sm font-medium">+12</span>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="award" class="w-6 h-6 text-white"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">87%</h3>
                            <p class="text-gray-600">Avg Progress</p>
                            <div class="flex items-center gap-1 mt-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-green-500 text-sm font-medium">+5.3%</span>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="target" class="w-6 h-6 text-white"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">23</h3>
                            <p class="text-gray-600">Active IDPs</p>
                            <div class="flex items-center gap-1 mt-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-green-500 text-sm font-medium">+3</span>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="clipboard-list" class="w-6 h-6 text-white"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Dashboard -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Team Progress Chart -->
                <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Team Learning Progress</h3>
                    </div>
                    <div class="p-6">
                        <canvas id="teamProgressChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <!-- Skills Distribution -->
                <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Skills Distribution</h3>
                    </div>
                    <div class="p-6">
                        <canvas id="skillsChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <!-- Performance Comparison -->
                <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Individual vs Team Average</h3>
                    </div>
                    <div class="p-6">
                        <canvas id="performanceChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <!-- Learning Velocity -->
                <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Learning Velocity Trends</h3>
                    </div>
                    <div class="p-6">
                        <canvas id="velocityChart" class="w-full h-64"></canvas>
                    </div>
                </div>
            </div>

            <!-- Team Member Performance -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Individual Performance Rankings -->
                <div class="lg:col-span-2 bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xl font-bold text-gray-900">Team Member Performance</h3>
                            <select id="sortMetric" onchange="sortTeamMembers()" 
                                    class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                <option value="progress">Sort by Progress</option>
                                <option value="courses">Sort by Courses</option>
                                <option value="certificates">Sort by Certificates</option>
                                <option value="engagement">Sort by Engagement</option>
                            </select>
                        </div>
                    </div>
                    <div class="p-6">
                        <div id="teamMembersRanking" class="space-y-4">
                            <!-- Team member rankings will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Skills Gap Analysis -->
                <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                    <div class="p-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Skills Gap Insights</h3>
                    </div>
                    <div class="p-6">
                        <div class="space-y-6">
                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-gray-600">Cloud Technologies</span>
                                    <span class="text-red-600 font-medium">Critical Gap</span>
                                </div>
                                <div class="w-full h-3 bg-gray-200 rounded-full">
                                    <div class="w-1/4 h-3 bg-red-500 rounded-full"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">Only 2 of 12 team members proficient</div>
                                <button onclick="recommendTraining('cloud')" class="text-green-600 text-xs hover:text-green-700 mt-2">
                                    Recommend Training â†’
                                </button>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-gray-600">Data Analytics</span>
                                    <span class="text-yellow-600 font-medium">Moderate Gap</span>
                                </div>
                                <div class="w-full h-3 bg-gray-200 rounded-full">
                                    <div class="w-1/2 h-3 bg-yellow-500 rounded-full"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">6 of 12 team members proficient</div>
                                <button onclick="recommendTraining('analytics')" class="text-green-600 text-xs hover:text-green-700 mt-2">
                                    Recommend Training â†’
                                </button>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-gray-600">Leadership Skills</span>
                                    <span class="text-green-600 font-medium">Strong</span>
                                </div>
                                <div class="w-full h-3 bg-gray-200 rounded-full">
                                    <div class="w-5/6 h-3 bg-green-500 rounded-full"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">10 of 12 team members proficient</div>
                            </div>

                            <div>
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-gray-600">Project Management</span>
                                    <span class="text-green-600 font-medium">Good</span>
                                </div>
                                <div class="w-full h-3 bg-gray-200 rounded-full">
                                    <div class="w-3/4 h-3 bg-green-500 rounded-full"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">9 of 12 team members proficient</div>
                            </div>

                            <div class="pt-4 border-t border-gray-200">
                                <button onclick="generateSkillsReport()" 
                                        class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                    <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Generate Skills Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Items & Recommendations -->
            <div class="mt-8 bg-white rounded-2xl border border-gray-100 hover-lift">
                <div class="p-6 border-b border-gray-100">
                    <h3 class="text-xl font-bold text-gray-900">AI-Powered Team Insights & Action Items</h3>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="p-4 bg-green-50 border border-green-200 rounded-xl">
                            <div class="flex items-center gap-3 mb-3">
                                <i data-lucide="trending-up" class="w-6 h-6 text-green-600"></i>
                                <h4 class="font-bold text-green-900">High Performers</h4>
                            </div>
                            <p class="text-sm text-green-800 mb-3">Madhumitha M and Kavya Krishnan showing exceptional learning velocity. Consider them for advanced projects and mentoring roles.</p>
                            <button onclick="assignMentorRole()" class="text-green-600 font-medium text-sm hover:text-green-700">
                                Assign Mentoring Roles â†’
                            </button>
                        </div>

                        <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                            <div class="flex items-center gap-3 mb-3">
                                <i data-lucide="alert-triangle" class="w-6 h-6 text-yellow-600"></i>
                                <h4 class="font-bold text-yellow-900">Attention Needed</h4>
                            </div>
                            <p class="text-sm text-yellow-800 mb-3">Rohit Mehta showing declining engagement (-15%). Recommend 1:1 discussion and personalized learning path.</p>
                            <button onclick="scheduleOneOnOne('Rohit Mehta')" class="text-yellow-600 font-medium text-sm hover:text-yellow-700">
                                Schedule 1:1 Meeting â†’
                            </button>
                        </div>

                        <div class="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                            <div class="flex items-center gap-3 mb-3">
                                <i data-lucide="lightbulb" class="w-6 h-6 text-blue-600"></i>
                                <h4 class="font-bold text-blue-900">Team Opportunity</h4>
                            </div>
                            <p class="text-sm text-blue-800 mb-3">Team shows strong collaboration skills. Perfect timing to introduce cross-functional project opportunities.</p>
                            <button onclick="createCrossFunctionalProject()" class="text-blue-600 font-medium text-sm hover:text-blue-700">
                                Create Team Project â†’
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        function exitApplication() {
            // Show confirmation dialog
            const confirmExit = confirm('Are you sure you want to log out?\n\nYou will be redirected to the login page.');
            
            if (confirmExit) {
                // Clear all stored data
                localStorage.clear();
                sessionStorage.clear();
                
                // Show loading state on exit button
                const exitBtn = document.querySelector('[onclick="exitApplication()"]');
                if (exitBtn) {
                    exitBtn.innerHTML = '<i data-lucide="loader" class="w-4 h-4 animate-spin"></i>';
                    exitBtn.disabled = true;
                    lucide.createIcons();
                }
                
                // Add fade-out effect and redirect
                setTimeout(() => {
                    document.body.style.transition = 'opacity 0.5s ease-out';
                    document.body.style.opacity = '0.5';
                    
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 500);
                }, 1000);
            }
        }
        
        // Initialize Lucide icons
        lucide.createIcons();

        // Team member data
        const teamMembers = [
            {
                name: 'Madhumitha M',
                position: 'Software Engineer',
                progress: 85,
                coursesCompleted: 12,
                certificates: 8,
                engagement: 94,
                avatar: 'MM',
                trend: 'up'
            },
            {
                name: 'Amit Nayak',
                position: 'Senior Developer',
                progress: 72,
                coursesCompleted: 9,
                certificates: 6,
                engagement: 78,
                avatar: 'AN',
                trend: 'stable'
            },
            {
                name: 'Kavya Krishnan',
                position: 'UI/UX Designer',
                progress: 91,
                coursesCompleted: 11,
                certificates: 7,
                engagement: 92,
                avatar: 'KK',
                trend: 'up'
            },
            {
                name: 'Rohit Mehta',
                position: 'Senior Accountant',
                progress: 56,
                coursesCompleted: 5,
                certificates: 3,
                engagement: 65,
                avatar: 'RM',
                trend: 'down'
            },
            {
                name: 'Vikram Sharma',
                position: 'Financial Analyst',
                progress: 67,
                coursesCompleted: 7,
                certificates: 4,
                engagement: 73,
                avatar: 'VS',
                trend: 'up'
            },
            {
                name: 'Neha Gupta',
                position: 'Marketing Manager',
                progress: 78,
                coursesCompleted: 8,
                certificates: 5,
                engagement: 81,
                avatar: 'NG',
                trend: 'stable'
            }
        ];

        // Check if user has manager role
        document.addEventListener('DOMContentLoaded', function() {
            const userRole = localStorage.getItem('userRole');
            if (userRole !== 'manager') {
                window.location.href = 'login.html';
            }
            
            initializeCharts();
            renderTeamMembers();
        });

        function initializeCharts() {
            // Team Progress Chart
            const progressCtx = document.getElementById('teamProgressChart').getContext('2d');
            new Chart(progressCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                    datasets: [{
                        label: 'Team Average',
                        data: [65, 68, 72, 75, 78, 82, 85, 87, 89, 92],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Department Average',
                        data: [60, 62, 65, 68, 71, 74, 77, 79, 81, 83],
                        borderColor: '#6B7280',
                        backgroundColor: 'rgba(107, 114, 128, 0.1)',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            // Skills Distribution Chart
            const skillsCtx = document.getElementById('skillsChart').getContext('2d');
            new Chart(skillsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Technical', 'Leadership', 'Communication', 'Project Mgmt', 'Analytics'],
                    datasets: [{
                        data: [85, 78, 92, 75, 68],
                        backgroundColor: ['#3B82F6', '#10B981', '#8B5CF6', '#F59E0B', '#EF4444'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Performance Comparison Chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: teamMembers.map(member => member.name.split(' ')[0]),
                    datasets: [{
                        label: 'Individual Progress',
                        data: teamMembers.map(member => member.progress),
                        backgroundColor: '#10B981'
                    }, {
                        label: 'Team Average',
                        data: Array(teamMembers.length).fill(75),
                        backgroundColor: '#6B7280'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // Learning Velocity Chart
            const velocityCtx = document.getElementById('velocityChart').getContext('2d');
            new Chart(velocityCtx, {
                type: 'radar',
                data: {
                    labels: ['Course Completion', 'Skill Acquisition', 'Engagement', 'Collaboration', 'Innovation', 'Problem Solving'],
                    datasets: [{
                        label: 'Current Quarter',
                        data: [87, 82, 92, 88, 75, 89],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        pointBackgroundColor: '#10B981'
                    }, {
                        label: 'Previous Quarter',
                        data: [79, 76, 85, 82, 70, 84],
                        borderColor: '#6B7280',
                        backgroundColor: 'rgba(107, 114, 128, 0.2)',
                        pointBackgroundColor: '#6B7280'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function renderTeamMembers() {
            const container = document.getElementById('teamMembersRanking');
            container.innerHTML = '';

            teamMembers.forEach((member, index) => {
                const trendIcon = member.trend === 'up' ? 'trending-up' : 
                                 member.trend === 'down' ? 'trending-down' : 'minus';
                const trendColor = member.trend === 'up' ? 'text-green-500' : 
                                  member.trend === 'down' ? 'text-red-500' : 'text-gray-500';

                const memberCard = document.createElement('div');
                memberCard.className = 'flex items-center justify-between p-4 bg-gray-50 border border-gray-200 rounded-xl hover:bg-gray-100 transition-colors';
                memberCard.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-bold text-gray-500 w-6">#${index + 1}</span>
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <span class="text-green-600 font-bold text-sm">${member.avatar}</span>
                            </div>
                        </div>
                        <div>
                            <div class="font-bold text-gray-900">${member.name}</div>
                            <div class="text-sm text-gray-600">${member.position}</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-6">
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">${member.progress}%</div>
                            <div class="text-xs text-gray-500">Progress</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">${member.coursesCompleted}</div>
                            <div class="text-xs text-gray-500">Courses</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">${member.certificates}</div>
                            <div class="text-xs text-gray-500">Certificates</div>
                        </div>
                        <div class="text-center">
                            <div class="flex items-center gap-1">
                                <span class="text-lg font-bold text-gray-900">${member.engagement}%</span>
                                <i data-lucide="${trendIcon}" class="w-4 h-4 ${trendColor}"></i>
                            </div>
                            <div class="text-xs text-gray-500">Engagement</div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="viewMemberDetails('${member.name}')" 
                                    class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors">
                                View
                            </button>
                            <button onclick="scheduleOneOnOne('${member.name}')" 
                                    class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors">
                                1:1
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(memberCard);
            });

            lucide.createIcons();
        }

        function sortTeamMembers() {
            const metric = document.getElementById('sortMetric').value;
            
            teamMembers.sort((a, b) => {
                switch(metric) {
                    case 'courses': return b.coursesCompleted - a.coursesCompleted;
                    case 'certificates': return b.certificates - a.certificates;
                    case 'engagement': return b.engagement - a.engagement;
                    default: return b.progress - a.progress;
                }
            });
            
            renderTeamMembers();
        }

        function updateAnalytics() {
            const timeRange = document.getElementById('timeRange').value;
            showNotification(`Analytics updated for last ${timeRange} days`, 'info');
        }

        function exportTeamReport() {
            showNotification('Generating comprehensive team analytics report...', 'info');
            
            setTimeout(() => {
                const reportData = [
                    'Team Member,Position,Progress %,Courses Completed,Certificates,Engagement %,Trend',
                    ...teamMembers.map(member => 
                        `"${member.name}","${member.position}","${member.progress}%","${member.coursesCompleted}","${member.certificates}","${member.engagement}%","${member.trend}"`
                    )
                ];
                
                const csvContent = "data:text/csv;charset=utf-8," + reportData.join("\\n");
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `Team_Analytics_Report_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('Team analytics report exported successfully!', 'success');
            }, 2000);
        }

        function recommendTraining(skill) {
            const skillNames = {
                'cloud': 'Cloud Technologies',
                'analytics': 'Data Analytics'
            };
            showNotification(`Creating ${skillNames[skill]} training recommendation for team`, 'success');
        }

        function generateSkillsReport() {
            showNotification('Generating detailed skills gap analysis...', 'info');
            
            setTimeout(() => {
                const skillsData = [
                    'Skill Area,Team Proficiency %,Gap Level,Recommended Action',
                    'Cloud Technologies,25%,Critical,Immediate training required',
                    'Data Analytics,50%,Moderate,Schedule training in Q1',
                    'Leadership Skills,83%,Low,Mentoring opportunities',
                    'Project Management,75%,Low,Advanced certification'
                ];
                
                const csvContent = "data:text/csv;charset=utf-8," + skillsData.join("\\n");
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `Team_Skills_Gap_Analysis_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('Skills gap report generated successfully!', 'success');
            }, 1500);
        }

        function viewMemberDetails(name) {
            showNotification(`Opening detailed analytics for ${name}...`, 'info');
        }

        function scheduleOneOnOne(name) {
            showNotification(`Scheduling 1:1 meeting with ${name}...`, 'info');
        }

        function assignMentorRole() {
            showNotification('Assigning mentoring roles to high performers...', 'success');
        }

        function createCrossFunctionalProject() {
            showNotification('Creating cross-functional project assignment...', 'info');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>