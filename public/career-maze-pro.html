<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Maze Champion - Professional Gaming Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .gold { background: linear-gradient(45deg, #FFD700, #FFA500); }
        .gold-text { background: linear-gradient(45deg, #FFD700, #FFA500); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .game-glow { box-shadow: 0 0 50px rgba(59, 130, 246, 0.5); }
        .pulse-glow { animation: pulseGlow 2s infinite; }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); } 50% { box-shadow: 0 0 40px rgba(59, 130, 246, 0.8); } }
        .floating { animation: floating 3s ease-in-out infinite; }
        @keyframes floating { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .shimmer { background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.5) 50%, transparent 70%); background-size: 200% 200%; animation: shimmer 2s infinite; }
        @keyframes shimmer { 0% { background-position: -200% -200%; } 100% { background-position: 200% 200%; } }
        .neon-border { border: 2px solid; border-image: linear-gradient(45deg, #00ff00, #0099ff, #ff0099, #ffff00) 1; }
        .arcade-button { background: linear-gradient(45deg, #ff6b35, #f7931e); box-shadow: 0 8px 0 #d45d2b, 0 8px 25px rgba(0,0,0,0.3); transition: all 0.1s; }
        .arcade-button:active { transform: translateY(4px); box-shadow: 0 4px 0 #d45d2b, 0 4px 15px rgba(0,0,0,0.3); }
        .retro-grid { background-image: linear-gradient(rgba(0,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(0,255,255,0.1) 1px, transparent 1px); background-size: 20px 20px; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white">
    <!-- Professional Gaming Interface -->
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-black/50 backdrop-blur-sm border-b border-gray-700 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 gold rounded-xl flex items-center justify-center text-2xl font-bold text-black">üéÆ</div>
                        <div>
                            <h1 class="text-2xl font-bold gold-text">Career Maze Champion</h1>
                            <p class="text-gray-400 text-sm">Professional Gaming Experience</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-6">
                        <div class="text-center">
                            <div class="text-yellow-400 font-bold text-lg">‚≠ê 2,450</div>
                            <div class="text-gray-400 text-xs">Rating</div>
                        </div>
                        <div class="text-center">
                            <div class="text-green-400 font-bold text-lg">94%</div>
                            <div class="text-gray-400 text-xs">Win Rate</div>
                        </div>
                        <button class="bg-gradient-to-r from-purple-500 to-blue-500 px-4 py-2 rounded-lg font-medium hover:from-purple-600 hover:to-blue-600 transition-all">
                            üèÜ Leaderboard
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Game Interface -->
        <main class="flex-1 max-w-7xl mx-auto w-full p-6">
            <!-- Game Mode Selection Screen -->
            <div id="gameModeScreen" class="space-y-8">
                <div class="text-center mb-12">
                    <h2 class="text-5xl font-bold mb-4 gold-text">Choose Your Challenge</h2>
                    <p class="text-xl text-gray-300">Select a game mode to begin your professional journey</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Classic Mode -->
                    <div class="group bg-gradient-to-br from-blue-600 to-purple-700 rounded-3xl p-8 cursor-pointer hover:scale-105 transition-all duration-300 game-glow" onclick="startGameMode('classic')">
                        <div class="text-center">
                            <div class="text-6xl mb-6 floating">üéØ</div>
                            <h3 class="text-2xl font-bold mb-4">Classic Mode</h3>
                            <p class="text-blue-100 mb-6">Master the fundamentals of career navigation</p>
                            
                            <div class="space-y-3 text-sm text-left bg-black/20 rounded-xl p-4 mb-6">
                                <div class="flex items-center"><span class="text-green-400 mr-2">‚úì</span>Strategic thinking development</div>
                                <div class="flex items-center"><span class="text-green-400 mr-2">‚úì</span>Professional skill collection</div>
                                <div class="flex items-center"><span class="text-green-400 mr-2">‚úì</span>Career challenge simulation</div>
                                <div class="flex items-center"><span class="text-green-400 mr-2">‚úì</span>Progress tracking & analytics</div>
                            </div>
                            
                            <div class="arcade-button text-white px-6 py-3 rounded-xl font-bold text-lg">
                                üöÄ START CLASSIC
                            </div>
                            <div class="mt-3">
                                <span class="bg-green-500 px-3 py-1 rounded-full text-xs font-medium">FREE</span>
                            </div>
                        </div>
                    </div>

                    <!-- Speed Run Mode -->
                    <div class="group bg-gradient-to-br from-red-600 to-pink-700 rounded-3xl p-8 cursor-pointer hover:scale-105 transition-all duration-300 pulse-glow" onclick="startGameMode('speedrun')">
                        <div class="text-center">
                            <div class="text-6xl mb-6 floating" style="animation-delay: 1s">‚ö°</div>
                            <h3 class="text-2xl font-bold mb-4">Speed Run</h3>
                            <p class="text-red-100 mb-6">Race against time for maximum rewards</p>
                            
                            <div class="space-y-3 text-sm text-left bg-black/20 rounded-xl p-4 mb-6">
                                <div class="flex items-center"><span class="text-yellow-400 mr-2">‚òÖ</span>Time-based challenges</div>
                                <div class="flex items-center"><span class="text-yellow-400 mr-2">‚òÖ</span>Bonus point multipliers</div>
                                <div class="flex items-center"><span class="text-yellow-400 mr-2">‚òÖ</span>Leaderboard competition</div>
                                <div class="flex items-center"><span class="text-yellow-400 mr-2">‚òÖ</span>Achievement unlocking</div>
                            </div>
                            
                            <div class="arcade-button text-white px-6 py-3 rounded-xl font-bold text-lg">
                                ‚ö° START SPEEDRUN
                            </div>
                            <div class="mt-3">
                                <span class="bg-yellow-500 px-3 py-1 rounded-full text-xs font-medium text-black">PREMIUM</span>
                            </div>
                        </div>
                    </div>

                    <!-- Survival Mode -->
                    <div class="group bg-gradient-to-br from-green-600 to-teal-700 rounded-3xl p-8 cursor-pointer hover:scale-105 transition-all duration-300 neon-border" onclick="startGameMode('survival')">
                        <div class="text-center">
                            <div class="text-6xl mb-6 floating" style="animation-delay: 2s">üëë</div>
                            <h3 class="text-2xl font-bold mb-4">Survival Mode</h3>
                            <p class="text-green-100 mb-6">Endless challenges with escalating difficulty</p>
                            
                            <div class="space-y-3 text-sm text-left bg-black/20 rounded-xl p-4 mb-6">
                                <div class="flex items-center"><span class="text-purple-400 mr-2">üíé</span>Infinite level progression</div>
                                <div class="flex items-center"><span class="text-purple-400 mr-2">üíé</span>Elite skill mastery</div>
                                <div class="flex items-center"><span class="text-purple-400 mr-2">üíé</span>Champion status tracking</div>
                                <div class="flex items-center"><span class="text-purple-400 mr-2">üíé</span>Exclusive rewards system</div>
                            </div>
                            
                            <div class="arcade-button text-white px-6 py-3 rounded-xl font-bold text-lg shimmer">
                                üëë START SURVIVAL
                            </div>
                            <div class="mt-3">
                                <span class="bg-purple-500 px-3 py-1 rounded-full text-xs font-medium">VIP ONLY</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upgrade to Premium Section -->
                <div class="bg-gradient-to-r from-yellow-600 via-orange-600 to-red-600 rounded-3xl p-8 text-center mt-12">
                    <h3 class="text-3xl font-bold mb-4">üöÄ Upgrade to Premium</h3>
                    <p class="text-xl mb-6">Unlock advanced features and become a Career Maze Champion</p>
                    <div class="flex justify-center space-x-8 mb-6">
                        <div class="text-center">
                            <div class="text-4xl mb-2">‚ö°</div>
                            <div class="font-medium">Speed Run Mode</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-2">üëë</div>
                            <div class="font-medium">Survival Mode</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-2">üìä</div>
                            <div class="font-medium">Advanced Analytics</div>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-2">üé®</div>
                            <div class="font-medium">Custom Themes</div>
                        </div>
                    </div>
                    <button class="bg-white text-gray-900 px-8 py-4 rounded-xl font-bold text-xl hover:bg-gray-100 transition-all arcade-button">
                        üí≥ Upgrade for $9.99/month
                    </button>
                    <p class="text-sm mt-3 opacity-90">7-day free trial ‚Ä¢ Cancel anytime ‚Ä¢ Money-back guarantee</p>
                </div>
            </div>

            <!-- Game Playing Interface -->
            <div id="gamePlayScreen" class="hidden">
                <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
                    <!-- Game Canvas Area -->
                    <div class="xl:col-span-3">
                        <div class="bg-black rounded-3xl p-6 game-glow retro-grid">
                            <!-- Game Header -->
                            <div class="flex justify-between items-center mb-6">
                                <div class="flex items-center space-x-4">
                                    <button onclick="showGameModes()" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg">
                                        ‚Üê Back
                                    </button>
                                    <div class="flex items-center space-x-3">
                                        <div class="text-3xl">üéÆ</div>
                                        <div>
                                            <h3 class="text-xl font-bold">Career Maze Arena</h3>
                                            <div id="gameModeIndicator" class="text-blue-400 text-sm">Classic Mode</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex space-x-3">
                                    <button id="pauseBtn" onclick="togglePause()" class="bg-yellow-500 hover:bg-yellow-600 px-4 py-2 rounded-lg font-medium">
                                        ‚è∏Ô∏è Pause
                                    </button>
                                    <button onclick="resetGame()" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg font-medium">
                                        üîÑ Reset
                                    </button>
                                    <button id="nextLevelBtn" onclick="nextLevel()" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg font-medium hidden">
                                        ‚û°Ô∏è Next Level
                                    </button>
                                </div>
                            </div>

                            <!-- Game Canvas -->
                            <div class="relative">
                                <canvas id="gameCanvas" width="1200" height="800" class="border-4 border-blue-400 rounded-2xl bg-gradient-to-br from-blue-50 to-purple-50 w-full max-w-full"></canvas>
                                
                                <!-- Game Overlay -->
                                <div id="gameOverlay" class="absolute inset-0 bg-black/75 rounded-2xl flex items-center justify-center hidden">
                                    <div class="text-center text-white">
                                        <div id="overlayIcon" class="text-8xl mb-4">‚è∏Ô∏è</div>
                                        <h3 id="overlayTitle" class="text-4xl font-bold mb-4">Game Paused</h3>
                                        <p id="overlayMessage" class="text-xl mb-6">Take a moment to strategize</p>
                                        <button onclick="togglePause()" class="bg-green-500 hover:bg-green-600 px-8 py-4 rounded-xl font-bold text-xl">
                                            ‚ñ∂Ô∏è Resume Game
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Game Status Bar -->
                            <div class="mt-6 flex justify-between items-center">
                                <div id="gameInstructions" class="text-lg font-medium">
                                    Use <kbd class="bg-gray-700 px-2 py-1 rounded">WASD</kbd> or <kbd class="bg-gray-700 px-2 py-1 rounded">Arrow Keys</kbd> to navigate
                                </div>
                                <div class="flex items-center space-x-4 text-sm">
                                    <div id="difficultyDisplay" class="bg-gray-700 px-3 py-1 rounded-full">Difficulty: Normal</div>
                                    <div id="fpsDisplay" class="bg-gray-700 px-3 py-1 rounded-full">FPS: 60</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Game Dashboard -->
                    <div class="space-y-6">
                        <!-- Player Profile -->
                        <div class="bg-gradient-to-br from-purple-800 to-blue-800 rounded-3xl p-6 text-center">
                            <div class="w-20 h-20 gold rounded-full mx-auto flex items-center justify-center text-3xl font-bold text-black mb-4">MM</div>
                            <h4 class="text-xl font-bold mb-2">Madhumitha M</h4>
                            <p class="text-purple-200 mb-4">Career Champion</p>
                            
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div class="bg-black/30 rounded-lg p-3">
                                    <div class="text-yellow-400 font-medium">Rating</div>
                                    <div id="playerRating" class="text-2xl font-bold">2,450</div>
                                </div>
                                <div class="bg-black/30 rounded-lg p-3">
                                    <div class="text-green-400 font-medium">Streak</div>
                                    <div id="winStreak" class="text-2xl font-bold">7</div>
                                </div>
                            </div>
                        </div>

                        <!-- Live Game Stats -->
                        <div class="bg-gradient-to-br from-gray-800 to-black rounded-3xl p-6">
                            <h4 class="text-xl font-bold mb-6 flex items-center">
                                üìä Live Stats
                            </h4>
                            
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Level:</span>
                                    <div class="flex items-center space-x-2">
                                        <span id="levelDisplay" class="text-2xl font-bold text-blue-400">1</span>
                                        <div class="w-16 bg-gray-700 rounded-full h-2">
                                            <div id="levelProgress" class="bg-blue-400 h-2 rounded-full transition-all" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Time:</span>
                                    <span id="timeDisplay" class="text-xl font-mono text-green-400">00:00</span>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Score:</span>
                                    <span id="scoreDisplay" class="text-xl font-bold text-yellow-400">0</span>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Moves:</span>
                                    <span id="movesDisplay" class="text-xl font-bold text-purple-400">0</span>
                                </div>
                                
                                <div class="border-t border-gray-700 pt-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-400">Skills:</span>
                                        <span id="skillsCount" class="text-yellow-400 font-bold">0/4</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <div id="skill1" class="w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-lg">üéØ</div>
                                        <div id="skill2" class="w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-lg">üíº</div>
                                        <div id="skill3" class="w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-lg">üöÄ</div>
                                        <div id="skill4" class="w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-lg">üí°</div>
                                    </div>
                                </div>
                                
                                <div class="border-t border-gray-700 pt-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-400">Challenges:</span>
                                        <span id="challengesCount" class="text-red-400 font-bold">0/4</span>
                                    </div>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <div id="challenge1" class="bg-gray-700 rounded p-2 text-center opacity-50">Team Conflict</div>
                                        <div id="challenge2" class="bg-gray-700 rounded p-2 text-center opacity-50">Tight Deadline</div>
                                        <div id="challenge3" class="bg-gray-700 rounded p-2 text-center opacity-50">Complex Problem</div>
                                        <div id="challenge4" class="bg-gray-700 rounded p-2 text-center opacity-50">Performance Review</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Achievements -->
                        <div class="bg-gradient-to-br from-yellow-600 to-orange-600 rounded-3xl p-6">
                            <h4 class="text-xl font-bold mb-6">üèÜ Achievements</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <div id="achievement1" class="bg-black/30 rounded-lg p-3 text-center opacity-50 transition-all">
                                    <div class="text-2xl mb-1">‚ö°</div>
                                    <div class="text-xs font-medium">Speed Demon</div>
                                </div>
                                <div id="achievement2" class="bg-black/30 rounded-lg p-3 text-center opacity-50 transition-all">
                                    <div class="text-2xl mb-1">üíé</div>
                                    <div class="text-xs font-medium">Perfect Run</div>
                                </div>
                                <div id="achievement3" class="bg-black/30 rounded-lg p-3 text-center opacity-50 transition-all">
                                    <div class="text-2xl mb-1">üéì</div>
                                    <div class="text-xs font-medium">Skill Master</div>
                                </div>
                                <div id="achievement4" class="bg-black/30 rounded-lg p-3 text-center opacity-50 transition-all">
                                    <div class="text-2xl mb-1">üëë</div>
                                    <div class="text-xs font-medium">Champion</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Professional Game Engine -->
    <script>
        // Game Engine Core
        class CareerMazeGame {
            constructor() {
                this.canvas = null;
                this.ctx = null;
                this.gameState = 'menu'; // menu, playing, paused, completed
                this.gameMode = 'classic';
                this.level = 1;
                this.score = 0;
                this.moves = 0;
                this.startTime = null;
                this.gameTimer = null;
                this.animationId = null;
                this.fps = 60;
                this.lastFrame = 0;
                
                // Game objects
                this.player = { x: 1, y: 1, size: 20, color: '#3B82F6' };
                this.goal = { x: 46, y: 30, unlocked: false };
                this.maze = [];
                this.skills = [];
                this.challenges = [];
                this.particles = [];
                
                // Game settings
                this.cellSize = 25;
                this.mazeWidth = 48;
                this.mazeHeight = 32;
                
                // Input handling
                this.keys = {};
                this.lastMoveTime = 0;
                this.moveDelay = 150; // ms between moves
                
                this.setupEventListeners();
            }
            
            setupEventListeners() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.code] = true;
                    e.preventDefault();
                });
                
                document.addEventListener('keyup', (e) => {
                    this.keys[e.code] = false;
                });
            }
            
            startGame(mode) {
                this.gameMode = mode;
                this.gameState = 'playing';
                this.level = 1;
                this.score = 0;
                this.moves = 0;
                this.startTime = Date.now();
                
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                
                this.generateMaze();
                this.initializeGameObjects();
                this.startGameLoop();
                this.startTimer();
                
                document.getElementById('gameModeScreen').classList.add('hidden');
                document.getElementById('gamePlayScreen').classList.remove('hidden');
                
                document.getElementById('gameModeIndicator').textContent = 
                    mode === 'classic' ? 'Classic Mode' : 
                    mode === 'speedrun' ? 'Speed Run Mode' : 'Survival Mode';
            }
            
            generateMaze() {
                // Initialize maze dimensions for better visibility
                this.mazeWidth = 48;
                this.mazeHeight = 32;
                this.cellSize = 25;
                
                // Create maze grid - start with all walls
                this.maze = [];
                for (let y = 0; y < this.mazeHeight; y++) {
                    this.maze[y] = [];
                    for (let x = 0; x < this.mazeWidth; x++) {
                        this.maze[y][x] = 1; // 1 = wall, 0 = path
                    }
                }
                
                // Create guaranteed solvable maze with clear paths
                this.createSimpleMaze();
                
                // Ensure start and goal are accessible
                this.maze[1][1] = 0; // Start position
                this.maze[this.goal.y][this.goal.x] = 0; // Goal position
                
                // Create guaranteed path from start to goal
                this.createGuaranteedPath();
            }
            
            createSimpleMaze() {
                // Create a simple maze pattern with guaranteed paths
                for (let y = 1; y < this.mazeHeight - 1; y += 2) {
                    for (let x = 1; x < this.mazeWidth - 1; x += 2) {
                        // Create open cells
                        this.maze[y][x] = 0;
                        
                        // Randomly create connections
                        if (Math.random() > 0.3 && x + 1 < this.mazeWidth - 1) {
                            this.maze[y][x + 1] = 0; // Right connection
                        }
                        if (Math.random() > 0.3 && y + 1 < this.mazeHeight - 1) {
                            this.maze[y + 1][x] = 0; // Down connection
                        }
                    }
                }
                
                // Add some additional random paths for complexity
                for (let i = 0; i < 50; i++) {
                    const x = Math.floor(Math.random() * (this.mazeWidth - 2)) + 1;
                    const y = Math.floor(Math.random() * (this.mazeHeight - 2)) + 1;
                    this.maze[y][x] = 0;
                }
            }
            
            createGuaranteedPath() {
                // Create a guaranteed path from start (1,1) to goal
                let currentX = 1;
                let currentY = 1;
                
                // Move towards goal with some randomness
                while (currentX < this.goal.x - 1 || currentY < this.goal.y - 1) {
                    this.maze[currentY][currentX] = 0;
                    
                    // Decide direction - bias toward goal
                    const toGoalX = this.goal.x - currentX;
                    const toGoalY = this.goal.y - currentY;
                    
                    if (Math.abs(toGoalX) > Math.abs(toGoalY) && Math.random() > 0.3) {
                        // Move horizontally toward goal
                        if (toGoalX > 0 && currentX < this.mazeWidth - 2) currentX++;
                        else if (toGoalX < 0 && currentX > 1) currentX--;
                    } else {
                        // Move vertically toward goal
                        if (toGoalY > 0 && currentY < this.mazeHeight - 2) currentY++;
                        else if (toGoalY < 0 && currentY > 1) currentY--;
                    }
                }
                
                // Ensure final connection to goal
                this.maze[this.goal.y][this.goal.x] = 0;
            }
            
            getUnvisitedNeighbors(cell) {
                const neighbors = [];
                const directions = [
                    { x: 0, y: -2 }, { x: 2, y: 0 }, { x: 0, y: 2 }, { x: -2, y: 0 }
                ];
                
                for (const dir of directions) {
                    const nx = cell.x + dir.x;
                    const ny = cell.y + dir.y;
                    
                    if (nx > 0 && nx < this.mazeWidth - 1 && 
                        ny > 0 && ny < this.mazeHeight - 1 && 
                        this.maze[ny][nx] === 1) {
                        neighbors.push({ x: nx, y: ny });
                    }
                }
                
                return neighbors;
            }
            
            removeWall(current, next) {
                const wallX = current.x + (next.x - current.x) / 2;
                const wallY = current.y + (next.y - current.y) / 2;
                this.maze[wallY][wallX] = 0;
            }
            
            initializeGameObjects() {
                // Reset player position
                this.player.x = 1;
                this.player.y = 1;
                
                // Generate skills in guaranteed open positions
                this.skills = [
                    { x: 7, y: 5, collected: false, type: 'leadership', icon: 'üéØ', name: 'Leadership' },
                    { x: 19, y: 11, collected: false, type: 'technical', icon: 'üíº', name: 'Technical' },
                    { x: 31, y: 17, collected: false, type: 'management', icon: 'üöÄ', name: 'Management' },
                    { x: 13, y: 23, collected: false, type: 'innovation', icon: 'üí°', name: 'Innovation' }
                ];
                
                // Generate challenges in guaranteed open positions
                this.challenges = [
                    { x: 11, y: 7, completed: false, type: 'conflict', name: 'Team Conflict' },
                    { x: 23, y: 13, completed: false, type: 'deadline', name: 'Tight Deadline' },
                    { x: 35, y: 21, completed: false, type: 'problem', name: 'Complex Problem' },
                    { x: 9, y: 19, completed: false, type: 'review', name: 'Performance Review' }
                ];
                
                // Ensure all objects are in valid positions (after maze generation)
                this.ensureValidPositions();
                
                this.goal.unlocked = false;
            }
            
            ensureValidPositions() {
                // Ensure all skills are in open positions
                this.skills.forEach(skill => {
                    if (this.maze[skill.y] && this.maze[skill.y][skill.x] === 1) {
                        const openPos = this.findNearestOpenCell(skill.x, skill.y);
                        skill.x = openPos.x;
                        skill.y = openPos.y;
                    }
                });
                
                // Ensure all challenges are in open positions  
                this.challenges.forEach(challenge => {
                    if (this.maze[challenge.y] && this.maze[challenge.y][challenge.x] === 1) {
                        const openPos = this.findNearestOpenCell(challenge.x, challenge.y);
                        challenge.x = openPos.x;
                        challenge.y = openPos.y;
                    }
                });
            }
            
            findNearestOpenCell(x, y) {
                // First check if current position is already open
                if (x >= 0 && x < this.mazeWidth && y >= 0 && y < this.mazeHeight && this.maze[y][x] === 0) {
                    return { x, y };
                }
                
                // Search in expanding circles for an open cell
                for (let radius = 1; radius < 20; radius++) {
                    for (let dx = -radius; dx <= radius; dx++) {
                        for (let dy = -radius; dy <= radius; dy++) {
                            const nx = x + dx;
                            const ny = y + dy;
                            if (nx >= 0 && nx < this.mazeWidth && 
                                ny >= 0 && ny < this.mazeHeight && 
                                this.maze[ny][nx] === 0) {
                                return { x: nx, y: ny };
                            }
                        }
                    }
                }
                
                // Fallback to guaranteed open positions
                const guaranteedOpen = [
                    { x: 1, y: 1 }, { x: 3, y: 3 }, { x: 5, y: 5 }, { x: 7, y: 7 }
                ];
                return guaranteedOpen[Math.floor(Math.random() * guaranteedOpen.length)];
            }
            
            startGameLoop() {
                const gameLoop = (timestamp) => {
                    if (this.gameState === 'playing') {
                        const deltaTime = timestamp - this.lastFrame;
                        this.lastFrame = timestamp;
                        
                        this.update(deltaTime);
                        this.render();
                        
                        // Calculate FPS
                        this.fps = Math.round(1000 / deltaTime);
                        document.getElementById('fpsDisplay').textContent = `FPS: ${this.fps}`;
                    }
                    
                    this.animationId = requestAnimationFrame(gameLoop);
                };
                
                this.animationId = requestAnimationFrame(gameLoop);
            }
            
            update(deltaTime) {
                this.handleInput();
                this.updateParticles(deltaTime);
                this.checkCollisions();
                this.updateUI();
            }
            
            handleInput() {
                const now = Date.now();
                if (now - this.lastMoveTime < this.moveDelay) return;
                
                let newX = this.player.x;
                let newY = this.player.y;
                
                if (this.keys['KeyW'] || this.keys['ArrowUp']) newY--;
                if (this.keys['KeyS'] || this.keys['ArrowDown']) newY++;
                if (this.keys['KeyA'] || this.keys['ArrowLeft']) newX--;
                if (this.keys['KeyD'] || this.keys['ArrowRight']) newX++;
                
                if (this.isValidMove(newX, newY)) {
                    this.player.x = newX;
                    this.player.y = newY;
                    this.moves++;
                    this.lastMoveTime = now;
                    
                    // Add movement particle
                    this.addParticle(this.player.x * this.cellSize, this.player.y * this.cellSize, '#3B82F6');
                }
            }
            
            isValidMove(x, y) {
                return x >= 0 && x < this.mazeWidth && 
                       y >= 0 && y < this.mazeHeight && 
                       this.maze[y][x] === 0;
            }
            
            checkCollisions() {
                // Check skill collection
                this.skills.forEach((skill, index) => {
                    if (!skill.collected && 
                        this.player.x === skill.x && 
                        this.player.y === skill.y) {
                        skill.collected = true;
                        this.score += 100;
                        this.addParticle(skill.x * this.cellSize, skill.y * this.cellSize, '#FCD34D');
                        this.updateSkillsUI();
                        
                        // Check if goal should be unlocked
                        if (this.skills.every(s => s.collected)) {
                            this.goal.unlocked = true;
                            this.addParticle(this.goal.x * this.cellSize, this.goal.y * this.cellSize, '#10B981');
                        }
                    }
                });
                
                // Check challenge completion
                this.challenges.forEach(challenge => {
                    if (!challenge.completed && 
                        this.player.x === challenge.x && 
                        this.player.y === challenge.y) {
                        challenge.completed = true;
                        this.score += 50;
                        this.addParticle(challenge.x * this.cellSize, challenge.y * this.cellSize, '#EF4444');
                    }
                });
                
                // Check goal reach
                if (this.goal.unlocked && 
                    this.player.x === this.goal.x && 
                    this.player.y === this.goal.y) {
                    this.completeLevel();
                }
            }
            
            addParticle(x, y, color) {
                for (let i = 0; i < 10; i++) {
                    this.particles.push({
                        x: x + this.cellSize / 2,
                        y: y + this.cellSize / 2,
                        vx: (Math.random() - 0.5) * 4,
                        vy: (Math.random() - 0.5) * 4,
                        life: 1,
                        decay: 0.02,
                        color: color,
                        size: Math.random() * 4 + 2
                    });
                }
            }
            
            updateParticles(deltaTime) {
                this.particles = this.particles.filter(particle => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.life -= particle.decay;
                    return particle.life > 0;
                });
            }
            
            render() {
                // Clear canvas
                this.ctx.fillStyle = '#1F2937';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Render maze
                this.renderMaze();
                
                // Render game objects
                this.renderSkills();
                this.renderChallenges();
                this.renderGoal();
                this.renderPlayer();
                
                // Render particles
                this.renderParticles();
            }
            
            renderMaze() {
                // Clear background
                this.ctx.fillStyle = '#F3F4F6';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Render maze walls
                for (let y = 0; y < this.mazeHeight; y++) {
                    for (let x = 0; x < this.mazeWidth; x++) {
                        if (this.maze[y][x] === 1) {
                            // Wall
                            this.ctx.fillStyle = '#1F2937';
                            this.ctx.fillRect(
                                x * this.cellSize, 
                                y * this.cellSize, 
                                this.cellSize, 
                                this.cellSize
                            );
                            
                            // Add border for better visibility
                            this.ctx.strokeStyle = '#374151';
                            this.ctx.lineWidth = 1;
                            this.ctx.strokeRect(
                                x * this.cellSize, 
                                y * this.cellSize, 
                                this.cellSize, 
                                this.cellSize
                            );
                        } else {
                            // Path - light background
                            this.ctx.fillStyle = '#FFFFFF';
                            this.ctx.fillRect(
                                x * this.cellSize, 
                                y * this.cellSize, 
                                this.cellSize, 
                                this.cellSize
                            );
                            
                            // Subtle grid lines for paths
                            this.ctx.strokeStyle = '#E5E7EB';
                            this.ctx.lineWidth = 0.5;
                            this.ctx.strokeRect(
                                x * this.cellSize, 
                                y * this.cellSize, 
                                this.cellSize, 
                                this.cellSize
                            );
                        }
                    }
                }
            }
            
            renderPlayer() {
                const x = this.player.x * this.cellSize + this.cellSize / 2;
                const y = this.player.y * this.cellSize + this.cellSize / 2;
                
                // Player shadow
                this.ctx.fillStyle = 'rgba(59, 130, 246, 0.3)';
                this.ctx.beginPath();
                this.ctx.arc(x + 2, y + 2, 12, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Player body
                this.ctx.fillStyle = '#3B82F6';
                this.ctx.beginPath();
                this.ctx.arc(x, y, 10, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Player emoji
                this.ctx.font = '16px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillStyle = 'white';
                this.ctx.fillText('üòä', x, y + 4);
            }
            
            renderSkills() {
                const time = Date.now() * 0.005;
                
                this.skills.forEach((skill, index) => {
                    if (!skill.collected) {
                        const x = skill.x * this.cellSize + this.cellSize / 2;
                        const y = skill.y * this.cellSize + this.cellSize / 2;
                        const bounce = Math.sin(time + index) * 3;
                        
                        // Skill glow effect
                        this.ctx.fillStyle = 'rgba(252, 211, 77, 0.5)';
                        this.ctx.beginPath();
                        this.ctx.arc(x, y + bounce, 15, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        // Skill background
                        this.ctx.fillStyle = '#FCD34D';
                        this.ctx.beginPath();
                        this.ctx.arc(x, y + bounce, 10, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        // Skill border
                        this.ctx.strokeStyle = '#F59E0B';
                        this.ctx.lineWidth = 2;
                        this.ctx.stroke();
                        
                        // Render icon
                        this.ctx.font = 'bold 14px Arial';
                        this.ctx.textAlign = 'center';
                        this.ctx.fillStyle = '#92400E';
                        this.ctx.fillText(skill.icon, x, y + bounce + 3);
                        
                        // Skill name
                        this.ctx.font = '10px Arial';
                        this.ctx.fillStyle = '#374151';
                        this.ctx.fillText(skill.name, x, y + bounce + 20);
                    }
                });
            }
            
            renderChallenges() {
                this.challenges.forEach((challenge, index) => {
                    if (!challenge.completed) {
                        const x = challenge.x * this.cellSize + this.cellSize / 2;
                        const y = challenge.y * this.cellSize + this.cellSize / 2;
                        
                        // Challenge background
                        this.ctx.fillStyle = '#EF4444';
                        this.ctx.fillRect(x - 10, y - 10, 20, 20);
                        
                        // Challenge border
                        this.ctx.strokeStyle = '#DC2626';
                        this.ctx.lineWidth = 2;
                        this.ctx.strokeRect(x - 10, y - 10, 20, 20);
                        
                        // Challenge icon
                        this.ctx.fillStyle = 'white';
                        this.ctx.font = 'bold 14px Arial';
                        this.ctx.textAlign = 'center';
                        this.ctx.fillText('‚ö†Ô∏è', x, y + 4);
                        
                        // Challenge label
                        this.ctx.font = '8px Arial';
                        this.ctx.fillStyle = '#374151';
                        this.ctx.fillText(challenge.type.toUpperCase(), x, y + 18);
                    }
                });
            }
            
            renderGoal() {
                const x = this.goal.x * this.cellSize + this.cellSize / 2;
                const y = this.goal.y * this.cellSize + this.cellSize / 2;
                const time = Date.now() * 0.003;
                const glow = Math.sin(time) * 0.5 + 0.5;
                
                if (this.goal.unlocked) {
                    // Goal glow effect
                    this.ctx.fillStyle = `rgba(16, 185, 129, ${glow * 0.5})`;
                    this.ctx.beginPath();
                    this.ctx.arc(x, y, 20, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Goal trophy
                    this.ctx.font = 'bold 24px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillStyle = '#10B981';
                    this.ctx.fillText('üèÜ', x, y + 8);
                    
                    // Goal label
                    this.ctx.font = 'bold 10px Arial';
                    this.ctx.fillStyle = '#065F46';
                    this.ctx.fillText('CAREER GOAL', x, y + 25);
                } else {
                    // Locked goal
                    this.ctx.fillStyle = '#9CA3AF';
                    this.ctx.beginPath();
                    this.ctx.arc(x, y, 15, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    this.ctx.font = 'bold 20px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillStyle = '#6B7280';
                    this.ctx.fillText('üîí', x, y + 6);
                    
                    this.ctx.font = '8px Arial';
                    this.ctx.fillStyle = '#4B5563';
                    this.ctx.fillText('COLLECT ALL SKILLS', x, y + 22);
                }
            }
            
            renderParticles() {
                this.particles.forEach(particle => {
                    this.ctx.globalAlpha = particle.life;
                    this.ctx.fillStyle = particle.color;
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    this.ctx.fill();
                });
                this.ctx.globalAlpha = 1;
            }
            
            updateUI() {
                const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                
                document.getElementById('timeDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('scoreDisplay').textContent = this.score.toLocaleString();
                document.getElementById('movesDisplay').textContent = this.moves.toString();
                document.getElementById('levelDisplay').textContent = this.level.toString();
                
                // Update level progress
                const progress = (this.skills.filter(s => s.collected).length / this.skills.length) * 100;
                document.getElementById('levelProgress').style.width = `${progress}%`;
            }
            
            updateSkillsUI() {
                const collectedCount = this.skills.filter(s => s.collected).length;
                document.getElementById('skillsCount').textContent = `${collectedCount}/4`;
                
                this.skills.forEach((skill, index) => {
                    const skillElement = document.getElementById(`skill${index + 1}`);
                    if (skill.collected) {
                        skillElement.style.background = 'linear-gradient(45deg, #FCD34D, #F59E0B)';
                        skillElement.style.opacity = '1';
                    }
                });
            }
            
            completeLevel() {
                this.gameState = 'completed';
                this.score += Math.max(1000 - this.moves * 2, 500);
                
                // Show completion overlay
                document.getElementById('overlayIcon').textContent = 'üéâ';
                document.getElementById('overlayTitle').textContent = 'Level Complete!';
                document.getElementById('overlayMessage').textContent = 
                    `Score: ${this.score.toLocaleString()} ‚Ä¢ Moves: ${this.moves}`;
                document.getElementById('gameOverlay').classList.remove('hidden');
                
                // Show next level button
                document.getElementById('nextLevelBtn').classList.remove('hidden');
                
                // Check achievements
                this.checkAchievements();
            }
            
            checkAchievements() {
                const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                
                if (elapsed < 60) {
                    this.unlockAchievement('achievement1'); // Speed Demon
                }
                
                if (this.moves < 100) {
                    this.unlockAchievement('achievement2'); // Perfect Run
                }
                
                if (this.skills.every(s => s.collected)) {
                    this.unlockAchievement('achievement3'); // Skill Master
                }
                
                if (this.level >= 10) {
                    this.unlockAchievement('achievement4'); // Champion
                }
            }
            
            unlockAchievement(achievementId) {
                const element = document.getElementById(achievementId);
                element.style.opacity = '1';
                element.style.background = 'linear-gradient(45deg, #FCD34D, #F59E0B)';
            }
            
            startTimer() {
                this.gameTimer = setInterval(() => {
                    this.updateUI();
                }, 1000);
            }
            
            togglePause() {
                if (this.gameState === 'playing') {
                    this.gameState = 'paused';
                    document.getElementById('gameOverlay').classList.remove('hidden');
                    document.getElementById('pauseBtn').innerHTML = '‚ñ∂Ô∏è Resume';
                } else if (this.gameState === 'paused') {
                    this.gameState = 'playing';
                    document.getElementById('gameOverlay').classList.add('hidden');
                    document.getElementById('pauseBtn').innerHTML = '‚è∏Ô∏è Pause';
                }
            }
            
            resetGame() {
                this.level = 1;
                this.score = 0;
                this.moves = 0;
                this.startTime = Date.now();
                this.generateMaze();
                this.initializeGameObjects();
                document.getElementById('gameOverlay').classList.add('hidden');
                document.getElementById('nextLevelBtn').classList.add('hidden');
            }
            
            nextLevel() {
                this.level++;
                this.generateMaze();
                this.initializeGameObjects();
                this.gameState = 'playing';
                document.getElementById('gameOverlay').classList.add('hidden');
                document.getElementById('nextLevelBtn').classList.add('hidden');
            }
        }
        
        // Global game instance
        let game = new CareerMazeGame();
        
        // UI Functions
        function startGameMode(mode) {
            if (mode !== 'classic') {
                alert('üîí Premium feature! Upgrade to unlock this game mode.');
                return;
            }
            game.startGame(mode);
        }
        
        function showGameModes() {
            document.getElementById('gameModeScreen').classList.remove('hidden');
            document.getElementById('gamePlayScreen').classList.add('hidden');
            game.gameState = 'menu';
            
            if (game.animationId) {
                cancelAnimationFrame(game.animationId);
            }
            if (game.gameTimer) {
                clearInterval(game.gameTimer);
            }
        }
        
        function togglePause() {
            game.togglePause();
        }
        
        function resetGame() {
            game.resetGame();
        }
        
        function nextLevel() {
            game.nextLevel();
        }
        
        // Initialize icons
        lucide.createIcons();
    </script>
</body>
</html>