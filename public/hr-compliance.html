<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta viewport="width=device-width, initial-scale=1.0">
    <title>Policy & Compliance - POWERGRID IDP Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        powergrid: {
                            primary: "#232A7A",
                            secondary: "#DA251D", 
                            light: "#F8F9FA",
                            dark: "#495057",
                            accent: "#4A90E2"
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo and Title -->
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-600 to-purple-700 rounded-lg flex items-center justify-center">
                            <i data-lucide="shield-check" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-900">Policy & Compliance Management</h1>
                            <p class="text-sm text-gray-600">Ensure Organization-wide Regulatory Compliance</p>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:flex items-center gap-6">
                    <a href="hr-dashboard.html" class="text-gray-600 hover:text-purple-600 transition-colors">Organization</a>
                    <a href="hr-employees.html" class="text-gray-600 hover:text-purple-600 transition-colors">Employee Management</a>
                    <a href="hr-learning.html" class="text-gray-600 hover:text-purple-600 transition-colors">Learning & Content</a>
                    <a href="hr-compliance.html" class="text-purple-600 font-medium border-b-2 border-purple-600 pb-1">Policy & Compliance</a>
                    <a href="hr-idp-generator.html" class="text-gray-600 hover:text-purple-600 transition-colors">AI IDP Generator</a>
                </nav>

                <!-- User Section -->
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center">
                            <span class="text-white font-bold">PS</span>
                        </div>
                        <div class="hidden md:block">
                            <div class="text-sm font-medium text-gray-900">Priya Sharma</div>
                            <div class="text-xs text-gray-600">HR Director â€¢ Human Resources</div>
                        </div>
                    </div>
                    
                    <!-- Exit/Logout Button -->
                    <button onclick="exitApplication()" 
                            class="flex items-center justify-center w-10 h-10 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-all duration-300 shadow-md hover:shadow-lg"
                            title="Exit Application">
                        <i data-lucide="log-out" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="px-6 py-8">
        <div class="max-w-7xl mx-auto">
            <!-- Compliance Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="shield-check" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">98%</h3>
                            <p class="text-gray-600">Overall Compliance</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="file-text" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">47</h3>
                            <p class="text-gray-600">Active Policies</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="alert-triangle" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">23</h3>
                            <p class="text-gray-600">Pending Actions</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 border border-gray-100 hover-lift">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-red-500 to-red-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="clock" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">5</h3>
                            <p class="text-gray-600">Expired Certificates</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Compliance Dashboard -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Mandatory Training Compliance -->
                    <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                        <div class="p-6 border-b border-gray-100">
                            <div class="flex items-center justify-between">
                                <h3 class="text-xl font-bold text-gray-900">Mandatory Training Compliance</h3>
                                <button onclick="exportComplianceReport()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                    <i data-lucide="download" class="w-4 h-4 inline mr-2"></i>Export Report
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-6">
                                <!-- Safety Training -->
                                <div class="border border-gray-200 rounded-xl p-4">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="hard-hat" class="w-5 h-5 text-red-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-bold text-gray-900">Workplace Safety Training</h4>
                                                <p class="text-sm text-gray-600">Due: Every 12 months</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-yellow-600">89%</div>
                                            <div class="text-xs text-gray-600">1,110 / 1,247 completed</div>
                                        </div>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 rounded-full mb-3">
                                        <div class="w-[89%] h-3 bg-yellow-500 rounded-full"></div>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-gray-600">137 employees overdue</span>
                                        <button onclick="sendReminder('safety')" class="text-purple-600 hover:text-purple-700 font-medium">
                                            Send Reminder
                                        </button>
                                    </div>
                                </div>

                                <!-- Data Privacy Training -->
                                <div class="border border-gray-200 rounded-xl p-4">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="shield" class="w-5 h-5 text-blue-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-bold text-gray-900">Data Privacy & Security</h4>
                                                <p class="text-sm text-gray-600">Due: Every 18 months</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-green-600">95%</div>
                                            <div class="text-xs text-gray-600">1,185 / 1,247 completed</div>
                                        </div>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 rounded-full mb-3">
                                        <div class="w-[95%] h-3 bg-green-500 rounded-full"></div>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-gray-600">62 employees overdue</span>
                                        <button onclick="sendReminder('privacy')" class="text-purple-600 hover:text-purple-700 font-medium">
                                            Send Reminder
                                        </button>
                                    </div>
                                </div>

                                <!-- Code of Conduct -->
                                <div class="border border-gray-200 rounded-xl p-4">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="book-open" class="w-5 h-5 text-green-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-bold text-gray-900">Code of Conduct</h4>
                                                <p class="text-sm text-gray-600">Due: Annually</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-green-600">98%</div>
                                            <div class="text-xs text-gray-600">1,222 / 1,247 completed</div>
                                        </div>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 rounded-full mb-3">
                                        <div class="w-[98%] h-3 bg-green-500 rounded-full"></div>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-gray-600">25 employees overdue</span>
                                        <button onclick="sendReminder('conduct')" class="text-purple-600 hover:text-purple-700 font-medium">
                                            Send Reminder
                                        </button>
                                    </div>
                                </div>

                                <!-- Anti-Corruption Training -->
                                <div class="border border-gray-200 rounded-xl p-4">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="scales" class="w-5 h-5 text-purple-600"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-bold text-gray-900">Anti-Corruption & Ethics</h4>
                                                <p class="text-sm text-gray-600">Due: Every 24 months</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-green-600">92%</div>
                                            <div class="text-xs text-gray-600">1,147 / 1,247 completed</div>
                                        </div>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 rounded-full mb-3">
                                        <div class="w-[92%] h-3 bg-green-500 rounded-full"></div>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-gray-600">100 employees overdue</span>
                                        <button onclick="sendReminder('ethics')" class="text-purple-600 hover:text-purple-700 font-medium">
                                            Send Reminder
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Policy Management -->
                    <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                        <div class="p-6 border-b border-gray-100">
                            <div class="flex items-center justify-between">
                                <h3 class="text-xl font-bold text-gray-900">Policy Repository</h3>
                                <button onclick="addNewPolicy()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                    <i data-lucide="plus" class="w-4 h-4 inline mr-2"></i>New Policy
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <!-- Policy Search and Filters -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <input type="text" id="policySearch" placeholder="Search policies..." 
                                       class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                                       onkeyup="filterPolicies()">
                                <select id="policyCategory" onchange="filterPolicies()" 
                                        class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                    <option value="">All Categories</option>
                                    <option value="HR">Human Resources</option>
                                    <option value="Safety">Safety & Security</option>
                                    <option value="IT">Information Technology</option>
                                    <option value="Finance">Finance & Procurement</option>
                                    <option value="Operations">Operations</option>
                                </select>
                                <select id="policyStatus" onchange="filterPolicies()" 
                                        class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                    <option value="">All Status</option>
                                    <option value="Active">Active</option>
                                    <option value="Draft">Draft</option>
                                    <option value="Review">Under Review</option>
                                    <option value="Expired">Expired</option>
                                </select>
                            </div>

                            <!-- Policy List -->
                            <div id="policyList" class="space-y-3">
                                <!-- Policies will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar -->
                <div class="space-y-6">
                    <!-- Compliance Actions -->
                    <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                        <div class="p-6 border-b border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900">Quick Actions</h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3">
                                <button onclick="generateComplianceReport()" class="w-full flex items-center gap-3 p-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all">
                                    <i data-lucide="file-text" class="w-5 h-5"></i>
                                    <div class="text-left">
                                        <div class="font-medium">Generate Report</div>
                                        <div class="text-blue-200 text-sm">Compliance dashboard</div>
                                    </div>
                                </button>

                                <button onclick="scheduleAudit()" class="w-full flex items-center gap-3 p-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 transition-all">
                                    <i data-lucide="calendar-check" class="w-5 h-5"></i>
                                    <div class="text-left">
                                        <div class="font-medium">Schedule Audit</div>
                                        <div class="text-green-200 text-sm">Compliance verification</div>
                                    </div>
                                </button>

                                <button onclick="bulkNotifications()" class="w-full flex items-center gap-3 p-3 bg-gradient-to-r from-yellow-600 to-yellow-700 text-white rounded-xl hover:from-yellow-700 hover:to-yellow-800 transition-all">
                                    <i data-lucide="bell" class="w-5 h-5"></i>
                                    <div class="text-left">
                                        <div class="font-medium">Send Notifications</div>
                                        <div class="text-yellow-200 text-sm">Bulk reminders</div>
                                    </div>
                                </button>

                                <button onclick="updatePolicies()" class="w-full flex items-center gap-3 p-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-xl hover:from-purple-700 hover:to-purple-800 transition-all">
                                    <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                                    <div class="text-left">
                                        <div class="font-medium">Policy Updates</div>
                                        <div class="text-purple-200 text-sm">Version management</div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Alerts -->
                    <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                        <div class="p-6 border-b border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900">Recent Alerts</h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg">
                                    <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center mt-1">
                                        <i data-lucide="alert-triangle" class="w-4 h-4 text-red-600"></i>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-red-900">5 Safety Certificates Expired</div>
                                        <div class="text-xs text-red-600">Immediate action required</div>
                                        <div class="text-xs text-red-500 mt-1">2 hours ago</div>
                                    </div>
                                </div>

                                <div class="flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                    <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mt-1">
                                        <i data-lucide="clock" class="w-4 h-4 text-yellow-600"></i>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-yellow-900">Policy Review Due</div>
                                        <div class="text-xs text-yellow-600">IT Security Policy needs review</div>
                                        <div class="text-xs text-yellow-500 mt-1">1 day ago</div>
                                    </div>
                                </div>

                                <div class="flex items-start gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mt-1">
                                        <i data-lucide="info" class="w-4 h-4 text-blue-600"></i>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-blue-900">New Compliance Update</div>
                                        <div class="text-xs text-blue-600">GDPR guidelines updated</div>
                                        <div class="text-xs text-blue-500 mt-1">3 days ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Compliance Calendar -->
                    <div class="bg-white rounded-2xl border border-gray-100 hover-lift">
                        <div class="p-6 border-b border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900">Upcoming Deadlines</h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Annual Safety Audit</div>
                                        <div class="text-xs text-gray-600">Organization-wide assessment</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-red-600">15 Dec</div>
                                        <div class="text-xs text-gray-500">12 days</div>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">ISO Certification</div>
                                        <div class="text-xs text-gray-600">Quality management review</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-yellow-600">28 Jan</div>
                                        <div class="text-xs text-gray-500">56 days</div>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Data Protection Review</div>
                                        <div class="text-xs text-gray-600">GDPR compliance check</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-green-600">15 Mar</div>
                                        <div class="text-xs text-gray-500">102 days</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Policy Modal -->
    <div id="addPolicyModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl max-w-2xl w-full max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold text-gray-900">Add New Policy</h3>
                        <button onclick="closeAddPolicyModal()" class="text-gray-500 hover:text-gray-700">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
                <form id="addPolicyForm" class="p-6">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Policy Title *</label>
                            <input type="text" id="policyTitle" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                                <select id="newPolicyCategory" required 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                    <option value="">Select Category</option>
                                    <option value="HR">Human Resources</option>
                                    <option value="Safety">Safety & Security</option>
                                    <option value="IT">Information Technology</option>
                                    <option value="Finance">Finance & Procurement</option>
                                    <option value="Operations">Operations</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Effective Date *</label>
                                <input type="date" id="effectiveDate" required 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Policy Description *</label>
                            <textarea id="policyDesc" rows="4" required 
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                                      placeholder="Describe the policy purpose and scope..."></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Policy Document</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6">
                                <div class="text-center">
                                    <i data-lucide="file-text" class="w-8 h-8 text-gray-400 mx-auto mb-2"></i>
                                    <p class="text-gray-600 mb-2">Click to upload policy document</p>
                                    <button type="button" onclick="uploadPolicyDoc()" 
                                            class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                        Choose File
                                    </button>
                                    <p class="text-xs text-gray-500 mt-1">Supports: PDF, DOC, DOCX</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end gap-4 mt-8">
                        <button type="button" onclick="closeAddPolicyModal()" 
                                class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                            Add Policy
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        function exitApplication() {
            // Show confirmation dialog
            const confirmExit = confirm('Are you sure you want to log out?\n\nYou will be redirected to the login page.');
            
            if (confirmExit) {
                // Clear all stored data
                localStorage.clear();
                sessionStorage.clear();
                
                // Show loading state on exit button
                const exitBtn = document.querySelector('[onclick="exitApplication()"]');
                if (exitBtn) {
                    exitBtn.innerHTML = '<i data-lucide="loader" class="w-4 h-4 animate-spin"></i>';
                    exitBtn.disabled = true;
                    lucide.createIcons();
                }
                
                // Add fade-out effect and redirect
                setTimeout(() => {
                    document.body.style.transition = 'opacity 0.5s ease-out';
                    document.body.style.opacity = '0.5';
                    
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 500);
                }, 1000);
            }
        }
        
        // Initialize Lucide icons
        lucide.createIcons();

        // Sample policy data
        let policies = [
            {
                id: 'POL001',
                title: 'Employee Code of Conduct',
                category: 'HR',
                status: 'Active',
                effectiveDate: '2024-01-01',
                reviewDate: '2025-01-01',
                version: '2.1',
                compliance: 98
            },
            {
                id: 'POL002',
                title: 'Workplace Safety Guidelines',
                category: 'Safety',
                status: 'Active',
                effectiveDate: '2024-02-15',
                reviewDate: '2025-02-15',
                version: '1.8',
                compliance: 89
            },
            {
                id: 'POL003',
                title: 'IT Security Policy',
                category: 'IT',
                status: 'Review',
                effectiveDate: '2023-12-01',
                reviewDate: '2024-12-01',
                version: '3.2',
                compliance: 95
            },
            {
                id: 'POL004',
                title: 'Data Privacy Protection',
                category: 'IT',
                status: 'Active',
                effectiveDate: '2024-05-25',
                reviewDate: '2025-11-25',
                version: '1.5',
                compliance: 95
            },
            {
                id: 'POL005',
                title: 'Anti-Corruption Guidelines',
                category: 'HR',
                status: 'Active',
                effectiveDate: '2024-03-10',
                reviewDate: '2026-03-10',
                version: '1.2',
                compliance: 92
            },
            {
                id: 'POL006',
                title: 'Procurement Standards',
                category: 'Finance',
                status: 'Draft',
                effectiveDate: '2025-01-15',
                reviewDate: '2026-01-15',
                version: '1.0',
                compliance: 0
            }
        ];

        let filteredPolicies = [...policies];

        // Check if user has HR role
        document.addEventListener('DOMContentLoaded', function() {
            const userRole = localStorage.getItem('userRole');
            if (userRole !== 'hr') {
                window.location.href = 'login.html';
            }
            renderPolicyList();
        });

        function renderPolicyList() {
            const list = document.getElementById('policyList');
            list.innerHTML = '';
            
            filteredPolicies.forEach(policy => {
                const statusColor = policy.status === 'Active' ? 'bg-green-100 text-green-800' : 
                                   policy.status === 'Draft' ? 'bg-gray-100 text-gray-800' : 
                                   policy.status === 'Review' ? 'bg-yellow-100 text-yellow-800' : 
                                   'bg-red-100 text-red-800';

                const complianceColor = policy.compliance >= 95 ? 'text-green-600' :
                                       policy.compliance >= 85 ? 'text-yellow-600' : 'text-red-600';

                const policyItem = document.createElement('div');
                policyItem.className = 'flex items-center justify-between p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors';
                policyItem.innerHTML = `
                    <div class="flex items-center gap-4 flex-1">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="file-text" class="w-5 h-5 text-purple-600"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-1">
                                <h4 class="font-bold text-gray-900">${policy.title}</h4>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                                    ${policy.status}
                                </span>
                                <span class="text-xs text-gray-500">v${policy.version}</span>
                            </div>
                            <div class="flex items-center gap-4 text-sm text-gray-600">
                                <span>${policy.category}</span>
                                <span>Effective: ${new Date(policy.effectiveDate).toLocaleDateString()}</span>
                                <span>Review Due: ${new Date(policy.reviewDate).toLocaleDateString()}</span>
                                ${policy.status === 'Active' ? `<span class="font-medium ${complianceColor}">${policy.compliance}% compliance</span>` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="viewPolicy('${policy.id}')" class="text-blue-600 hover:text-blue-700" title="View Policy">
                            <i data-lucide="eye" class="w-4 h-4"></i>
                        </button>
                        <button onclick="editPolicy('${policy.id}')" class="text-green-600 hover:text-green-700" title="Edit Policy">
                            <i data-lucide="edit" class="w-4 h-4"></i>
                        </button>
                        <button onclick="downloadPolicy('${policy.id}')" class="text-purple-600 hover:text-purple-700" title="Download">
                            <i data-lucide="download" class="w-4 h-4"></i>
                        </button>
                    </div>
                `;
                list.appendChild(policyItem);
            });
            
            // Re-initialize Lucide icons
            lucide.createIcons();
        }

        function filterPolicies() {
            const searchTerm = document.getElementById('policySearch').value.toLowerCase();
            const categoryFilter = document.getElementById('policyCategory').value;
            const statusFilter = document.getElementById('policyStatus').value;
            
            filteredPolicies = policies.filter(policy => {
                const matchesSearch = policy.title.toLowerCase().includes(searchTerm) ||
                                    policy.id.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || policy.category === categoryFilter;
                const matchesStatus = !statusFilter || policy.status === statusFilter;
                
                return matchesSearch && matchesCategory && matchesStatus;
            });
            
            renderPolicyList();
        }

        // Compliance Functions
        function sendReminder(type) {
            const typeMap = {
                'safety': 'Workplace Safety Training',
                'privacy': 'Data Privacy & Security',
                'conduct': 'Code of Conduct',
                'ethics': 'Anti-Corruption & Ethics'
            };
            showNotification(`Reminder sent for ${typeMap[type]} compliance`, 'success');
        }

        function exportComplianceReport() {
            showNotification('Generating comprehensive compliance report...', 'info');
            // Simulate report generation
            setTimeout(() => {
                showNotification('Compliance report exported successfully!', 'success');
            }, 2000);
        }

        function generateComplianceReport() {
            showNotification('Generating detailed compliance analytics...', 'info');
        }

        function scheduleAudit() {
            showNotification('Opening audit scheduling interface...', 'info');
        }

        function bulkNotifications() {
            showNotification('Opening bulk notification center...', 'info');
        }

        function updatePolicies() {
            showNotification('Checking for policy updates...', 'info');
        }

        // Policy Management Functions
        function addNewPolicy() {
            document.getElementById('addPolicyModal').classList.remove('hidden');
        }

        function closeAddPolicyModal() {
            document.getElementById('addPolicyModal').classList.add('hidden');
            document.getElementById('addPolicyForm').reset();
        }

        function viewPolicy(id) {
            const policy = policies.find(p => p.id === id);
            showNotification(`Viewing policy: "${policy.title}"`, 'info');
        }

        function editPolicy(id) {
            const policy = policies.find(p => p.id === id);
            showNotification(`Opening editor for: "${policy.title}"`, 'info');
        }

        function downloadPolicy(id) {
            const policy = policies.find(p => p.id === id);
            showNotification(`Downloading: "${policy.title}"`, 'success');
        }

        function uploadPolicyDoc() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.pdf,.doc,.docx';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    showNotification(`Policy document "${file.name}" uploaded successfully!`, 'success');
                }
            };
            input.click();
        }

        // Handle add policy form submission
        document.getElementById('addPolicyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newPolicy = {
                id: `POL${String(policies.length + 1).padStart(3, '0')}`,
                title: document.getElementById('policyTitle').value,
                category: document.getElementById('newPolicyCategory').value,
                status: 'Draft',
                effectiveDate: document.getElementById('effectiveDate').value,
                reviewDate: new Date(new Date(document.getElementById('effectiveDate').value).getTime() + 365 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                version: '1.0',
                compliance: 0
            };
            
            policies.unshift(newPolicy);
            filteredPolicies = [...policies];
            renderPolicyList();
            closeAddPolicyModal();
            showNotification('Policy added successfully!', 'success');
        });

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>